<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Ultimate 3D Long Drive</title>
<style>
body { margin:0; overflow:hidden; background:#87CEEB; font-family:Arial; }
#ui {
  position:absolute;
  bottom:20px;
  left:50%;
  transform:translateX(-50%);
  width:400px;
  text-align:center;
  color:white;
}
#powerContainer {
  width:100%;
  height:20px;
  background:#333;
  border-radius:10px;
  overflow:hidden;
  margin-top:8px;
}
#powerBar { height:100%; width:0%; background:lime; }
#distance { margin-top:8px; font-size:20px; }
</style>
</head>
<body>

<div id="ui">
Hold SPACE to swing â€¢ Arrow Keys to Aim
<div id="powerContainer"><div id="powerBar"></div></div>
<div id="distance">Distance: 0m</div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.128/examples/js/loaders/GLTFLoader.js"></script>

<script>

let scene = new THREE.Scene();
let camera = new THREE.PerspectiveCamera(70, window.innerWidth/window.innerHeight, 0.1, 2000);
let renderer = new THREE.WebGLRenderer({antialias:true});
renderer.setSize(window.innerWidth, window.innerHeight);
document.body.appendChild(renderer.domElement);

// Lighting
scene.add(new THREE.HemisphereLight(0xffffff,0x444444,1.2));
let dirLight = new THREE.DirectionalLight(0xffffff,1);
dirLight.position.set(50,100,50);
scene.add(dirLight);

// TERRAIN (HILLS)
let terrainGeo = new THREE.PlaneGeometry(1000,1000,100,100);
terrainGeo.rotateX(-Math.PI/2);

for(let i=0;i<terrainGeo.attributes.position.count;i++){
  let y = Math.sin(i/5)*2 + Math.random()*1.5;
  terrainGeo.attributes.position.setY(i,y);
}
terrainGeo.computeVertexNormals();

let terrain = new THREE.Mesh(
  terrainGeo,
  new THREE.MeshStandardMaterial({color:0x2e8b57})
);
scene.add(terrain);

// BALL
let ball = new THREE.Mesh(
  new THREE.SphereGeometry(0.4,32,32),
  new THREE.MeshStandardMaterial({color:0xffffff})
);
ball.position.set(0,1,0);
scene.add(ball);

// REAL GOLFER MODEL
let golfer, mixer;
let loader = new THREE.GLTFLoader();

loader.load(
  "https://threejs.org/examples/models/gltf/Soldier.glb",
  function(gltf){
    golfer = gltf.scene;
    golfer.scale.set(1.5,1.5,1.5);
    golfer.position.set(0,0,4);
    scene.add(golfer);

    mixer = new THREE.AnimationMixer(golfer);
    let action = mixer.clipAction(gltf.animations[0]);
    action.play();
  }
);

// BETTER CLUB MODEL
let club = new THREE.Mesh(
  new THREE.CylinderGeometry(0.05,0.05,3,16),
  new THREE.MeshStandardMaterial({color:0x333333, metalness:0.8, roughness:0.2})
);
club.position.set(0.8,2,3);
club.rotation.z = Math.PI/2;
scene.add(club);

// Camera
camera.position.set(0,6,15);

let velocity = {x:0,y:0,z:0};
let gravity = -15;
let clock = new THREE.Clock();

let charging=false;
let power=0;
let powerDir=1;
let launched=false;
let aimAngle=0;

const powerBar=document.getElementById("powerBar");
const distanceUI=document.getElementById("distance");

// Controls
document.addEventListener("keydown", e=>{
  if(e.code==="Space" && !launched) charging=true;
  if(e.code==="ArrowLeft") aimAngle+=2;
  if(e.code==="ArrowRight") aimAngle-=2;
});
document.addEventListener("keyup", e=>{
  if(e.code==="Space" && charging && !launched){
    charging=false;
    launch();
  }
});

function launch(){
  launched=true;
  let strength=power*80;
  let rad=THREE.MathUtils.degToRad(aimAngle);

  velocity.z=-Math.cos(rad)*strength;
  velocity.x=Math.sin(rad)*strength;
  velocity.y=strength*0.7;
}

function resetGame(){
  ball.position.set(0,1,0);
  velocity={x:0,y:0,z:0};
  launched=false;
  power=0;
  aimAngle=0;
  distanceUI.innerHTML="Distance: 0m";
}

function animate(){
  requestAnimationFrame(animate);
  let delta=clock.getDelta();

  if(mixer) mixer.update(delta);

  if(charging){
    power+=powerDir*delta;
    if(power>=1){power=1;powerDir=-1;}
    if(power<=0){power=0;powerDir=1;}
    powerBar.style.width=(power*100)+"%";
  }

  if(launched){
    velocity.y+=gravity*delta;

    ball.position.x+=velocity.x*delta;
    ball.position.y+=velocity.y*delta;
    ball.position.z+=velocity.z*delta;

    camera.position.x=ball.position.x;
    camera.position.z=ball.position.z+20;
    camera.position.y=ball.position.y+8;
    camera.lookAt(ball.position);

    if(ball.position.y<=1){
      ball.position.y=1;
      launched=false;

      let dist=Math.sqrt(ball.position.x**2+ball.position.z**2).toFixed(1);
      distanceUI.innerHTML="Distance: "+dist+"m";

      setTimeout(resetGame,5000); // FULL RESET AFTER 5s
    }
  }

  renderer.render(scene,camera);
}

animate();

</script>
</body>
</html>
